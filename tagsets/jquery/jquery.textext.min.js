!function(t,e){function n(){}function o(){}function i(){}function r(t,e){"string"==typeof e&&(e=e.split("."));var n,o=e.join(".").replace(/\.(\w)/g,function(t,e){return e.toUpperCase()}),i=e.shift();return typeof(n=t[o])!=c?n=n:typeof(n=t[i])!=c&&e.length>0&&(n=r(n,e)),n}function s(){function t(t,e){i.bind(t,function(){return e.apply(o,arguments)})}var e,n=g.apply(arguments),o=this,i=1===n.length?o:n.shift();n=n[0]||{};for(e in n)t(e,n[e])}function a(t,e){return{input:t,form:e}}var u,l=(JSON||{}).stringify,g=Array.prototype.slice,c="undefined",p="item.manager",d="plugins",f="ext",h="html.wrap",m="html.hidden",v="keys",x="preInvalidate",w="postInvalidate",y="getFormData",D="setFormData",I="setInputData",E="postInit",P="ready",S={itemManager:o,plugins:[],ext:{},html:{wrap:'<div class="text-core"><div class="text-wrap"/></div>',hidden:'<input type="hidden" />'},keys:{8:"backspace",9:"tab",13:"enter!",27:"escape!",37:"left",38:"up!",39:"right",40:"down!",46:"delete",108:"numpadEnter"}};if(!l)throw new Error("JSON.stringify() not found");u=o.prototype,u.init=function(t){},u.filter=function(t,e){var n,o,i=[];for(n=0;n<t.length;n++)o=t[n],this.itemContains(o,e)&&i.push(o);return i},u.itemContains=function(t,e){return 0==this.itemToString(t).toLowerCase().indexOf(e.toLowerCase())},u.stringToItem=function(t){return t},u.itemToString=function(t){return t},u.compareItems=function(t,e){return t==e},u=n.prototype,u.init=function(e,n){var o,i,r,s=this;s._defaults=t.extend({},S),s._opts=n||{},s._plugins={},s._itemManager=i=new(s.opts(p)),e=t(e),r=t(s.opts(h)),o=t(s.opts(m)),e.wrap(r).keydown(function(t){return s.onKeyDown(t)}).keyup(function(t){return s.onKeyUp(t)}).data("textext",s),t(s).data({hiddenInput:o,wrapElement:e.parents(".text-wrap").first(),input:e}),o.attr("name",e.attr("name")),e.attr("name",null),o.insertAfter(e),t.extend(!0,i,s.opts(f+".item.manager")),t.extend(!0,s,s.opts(f+".*"),s.opts(f+".core")),s.originalWidth=e.outerWidth(),s.invalidateBounds(),i.init(s),s.initPatches(),s.initPlugins(s.opts(d),t.fn.textext.plugins),s.on({setFormData:s.onSetFormData,getFormData:s.onGetFormData,setInputData:s.onSetInputData,anyKeyUp:s.onAnyKeyUp}),s.trigger(E),s.trigger(P),s.getFormData(0)},u.initPatches=function(){var e,n=[],o=t.fn.textext.patches;for(e in o)n.push(e);this.initPlugins(n,o)},u.initPlugins=function(e,n){var o,i,r,s=this,a=[];for("string"==typeof e&&(e=e.split(/\s*,\s*|\s+/g)),r=0;r<e.length;r++)o=e[r],i=n[o],i&&(s._plugins[o]=i=new i,s[o]=function(t){return function(){return t}}(i),a.push(i),t.extend(!0,i,s.opts(f+".*"),s.opts(f+"."+o)));for(a.sort(function(t,e){return t=t.initPriority(),e=e.initPriority(),t===e?0:e>t?1:-1}),r=0;r<a.length;r++)a[r].init(s)},u.hasPlugin=function(t){return!!this._plugins[t]},u.on=s,u.bind=function(t,e){this.input().bind(t,e)},u.trigger=function(){var t=arguments;this.input().trigger(t[0],g.call(t,1))},u.itemManager=function(){return this._itemManager},u.input=function(){return t(this).data("input")},u.opts=function(t){var e=r(this._opts,t);return"undefined"==typeof e?r(this._defaults,t):e},u.wrapElement=function(){return t(this).data("wrapElement")},u.invalidateBounds=function(){var t,e=this,n=e.input(),o=e.wrapElement(),i=o.parent(),r=e.originalWidth+"px";e.trigger(x),t=n.outerHeight()+"px",n.css({width:r}),o.css({width:r,height:t}),i.css({height:t}),e.trigger(w)},u.focusInput=function(){this.input()[0].focus()},u.serializeData=l,u.hiddenInput=function(e){return t(this).data("hiddenInput")},u.getWeightedEventResponse=function(t,e){var n=this,o={},i=0;n.trigger(t,o,e);for(var r in o)i=Math.max(i,r);return o[i]},u.getFormData=function(t){var e=this,n=e.getWeightedEventResponse(y,t||0);e.trigger(D,n.form),e.trigger(I,n.input)},u.onAnyKeyUp=function(t,e){this.getFormData(e)},u.onSetInputData=function(t,e){this.input().val(e)},u.onSetFormData=function(t,e){var n=this;n.hiddenInput().val(n.serializeData(e))},u.onGetFormData=function(t,e){var n=this.input().val();e[0]=a(n,n)},t(["Down","Up"]).each(function(){var t=this.toString();u["onKey"+t]=function(e){var n=this,o=n.opts(v)[e.keyCode],i=!0;return o&&(i="!"!=o.substr(-1),o=o.replace("!",""),n.trigger(o+"Key"+t),"Up"==t&&n._lastKeyDown==e.keyCode&&(n._lastKeyDown=null,n.trigger(o+"KeyPress")),"Down"==t&&(n._lastKeyDown=e.keyCode)),n.trigger("anyKey"+t,e.keyCode),i}}),u=i.prototype,u.on=s,u.formDataObject=a,u.init=function(t){throw new Error("Not implemented")},u.baseInit=function(e,n){var o=this;e._defaults=t.extend(!0,e._defaults,n),o._core=e,o._timers={}},u.startTimer=function(t,e,n){var o=this;o.stopTimer(t),o._timers[t]=setTimeout(function(){delete o._timers[t],n.apply(o)},1e3*e)},u.stopTimer=function(t){clearTimeout(this._timers[t])},u.core=function(){return this._core},u.opts=function(t){return this.core().opts(t)},u.itemManager=function(){return this.core().itemManager()},u.input=function(){return this.core().input()},u.val=function(t){var e=this.input();return typeof t===c?e.val():void e.val(t)},u.trigger=function(){var t=this.core();t.trigger.apply(t,arguments)},u.bind=function(t,e){this.core().bind(t,e)},u.initPriority=function(){return 0};var T=!1,b=t.fn.textext=function(e){var o;return T||null==(o=t.fn.textext.css)||(t("head").append("<style>"+o+"</style>"),T=!0),this.map(function(){var o=t(this);if(null==e)return o.data("textext");var i=new n;return i.init(o,e),o.data("textext",i),i.input()[0]})};b.addPlugin=function(t,e){b.plugins[t]=e,e.prototype=new b.TextExtPlugin},b.addPatch=function(t,e){b.patches[t]=e,e.prototype=new b.TextExtPlugin},b.TextExt=n,b.TextExtPlugin=i,b.ItemManager=o,b.plugins={},b.patches={}}(jQuery),function(t){function e(){}t.fn.textext.TextExtIE9Patches=e,t.fn.textext.addPatch("ie9",e);var n=e.prototype;n.init=function(t){if(-1!=navigator.userAgent.indexOf("MSIE 9")){var e=this;t.on({postInvalidate:e.onPostInvalidate})}},n.onPostInvalidate=function(){var t=this,e=t.input(),n=e.val();e.val(Math.random()),e.val(n)}}(jQuery),function(t){function e(){}t.fn.textext.TextExtArrow=e,t.fn.textext.addPlugin("arrow",e);var n=e.prototype,o="html.arrow",i={html:{arrow:'<div class="text-arrow"/>'}};n.init=function(e){var n,r=this;r.baseInit(e,i),r._arrow=n=t(r.opts(o)),r.core().wrapElement().append(n),n.bind("click",function(t){r.onArrowClick(t)})},n.onArrowClick=function(t){this.trigger("toggleDropdown"),this.core().focusInput()}}(jQuery),function(t){function e(){}t.fn.textext.TextExtAutocomplete=e,t.fn.textext.addPlugin("autocomplete",e);var n=e.prototype,o=".",i="text-selected",r=o+i,s="text-suggestion",a=o+s,u="text-label",l=o+u,g="autocomplete.enabled",c="autocomplete.dropdown.position",p="autocomplete.dropdown.maxHeight",d="autocomplete.render",f="html.dropdown",h="html.suggestion",m="hideDropdown",v="showDropdown",x="getSuggestions",w="above",y="below",D="mousedownOnAutocomplete",I={autocomplete:{enabled:!0,dropdown:{position:y,maxHeight:"100px"}},html:{dropdown:'<div class="text-dropdown"><div class="text-list"/></div>',suggestion:'<div class="text-suggestion"><span class="text-label"/></div>'}};n.init=function(e){var n=this;n.baseInit(e,I);var o,i=n.input();n.opts(g)===!0&&(n.on({blur:n.onBlur,anyKeyUp:n.onAnyKeyUp,deleteKeyUp:n.onAnyKeyUp,backspaceKeyPress:n.onBackspaceKeyPress,enterKeyPress:n.onEnterKeyPress,escapeKeyPress:n.onEscapeKeyPress,setSuggestions:n.onSetSuggestions,showDropdown:n.onShowDropdown,hideDropdown:n.onHideDropdown,toggleDropdown:n.onToggleDropdown,postInvalidate:n.positionDropdown,getFormData:n.onGetFormData,downKeyDown:n.onDownKeyDown,upKeyDown:n.onUpKeyDown}),o=t(n.opts(f)),o.insertAfter(i),n.on(o,{mouseover:n.onMouseOver,mousedown:n.onMouseDown,click:n.onClick}),o.css("maxHeight",n.opts(p)).addClass("text-position-"+n.opts(c)),t(n).data("container",o),t(document.body).click(function(t){n.isDropdownVisible()&&!n.withinWrapElement(t.target)&&n.trigger(m)}),n.positionDropdown())},n.containerElement=function(){return t(this).data("container")},n.onMouseOver=function(e){var n=this,o=t(e.target);o.is(a)&&(n.clearSelected(),o.addClass(i))},n.onMouseDown=function(t){this.containerElement().data(D,!0)},n.onClick=function(e){var n=this,o=t(e.target);(o.is(a)||o.is(l))&&n.trigger("enterKeyPress"),n.core().hasPlugin("tags")&&n.val("")},n.onBlur=function(t){var e=this,n=e.containerElement(),o=n.data(D)===!0;e.isDropdownVisible()&&(o?e.core().focusInput():e.trigger(m)),n.removeData(D)},n.onBackspaceKeyPress=function(t){var e=this,n=e.val().length>0;(n||e.isDropdownVisible())&&e.getSuggestions()},n.onAnyKeyUp=function(t,e){var n=this,o=null!=n.opts("keys."+e);n.val().length>0&&!o&&n.getSuggestions()},n.onDownKeyDown=function(t){var e=this;e.isDropdownVisible()?e.toggleNextSuggestion():e.getSuggestions()},n.onUpKeyDown=function(t){this.togglePreviousSuggestion()},n.onEnterKeyPress=function(t){var e=this;e.isDropdownVisible()&&e.selectFromDropdown()},n.onEscapeKeyPress=function(t){var e=this;e.isDropdownVisible()&&e.trigger(m)},n.positionDropdown=function(){var t=this,e=t.containerElement(),n=t.opts(c),o=t.core().wrapElement().outerHeight(),i={};i[n===w?"bottom":"top"]=o+"px",e.css(i)},n.suggestionElements=function(){return this.containerElement().find(a)},n.setSelectedSuggestion=function(e){if(e){var n,o,r=this,a=r.suggestionElements(),u=a.first();for(r.clearSelected(),o=0;o<a.length;o++)if(n=t(a[o]),r.itemManager().compareItems(n.data(s),e)){u=n.addClass(i);break}u.addClass(i),r.scrollSuggestionIntoView(u)}},n.selectedSuggestionElement=function(){return this.suggestionElements().filter(r).first()},n.isDropdownVisible=function(){return this.containerElement().is(":visible")===!0},n.onGetFormData=function(t,e,n){var o=this,i=o.val(),r=i,s=i;e[100]=o.formDataObject(r,s)},n.initPriority=function(){return 200},n.onHideDropdown=function(t){this.hideDropdown()},n.onToggleDropdown=function(t){var e=this;e.trigger(e.containerElement().is(":visible")?m:v)},n.onShowDropdown=function(e,n){var o=this,i=o.selectedSuggestionElement().data(s),r=o._suggestions;return r?(t.isFunction(n)?n(o):(o.renderSuggestions(o._suggestions),o.toggleNextSuggestion()),o.showDropdown(o.containerElement()),void o.setSelectedSuggestion(i)):o.trigger(x)},n.onSetSuggestions=function(t,e){var n=this,o=n._suggestions=e.result;e.showHideDropdown!==!1&&n.trigger(null===o||0===o.length?m:v)},n.getSuggestions=function(){var t=this,e=t.val();t._previousInputValue!=e&&(""==e&&(current=null),t._previousInputValue=e,t.trigger(x,{query:e}))},n.clearItems=function(){this.containerElement().find(".text-list").children().remove()},n.renderSuggestions=function(e){var n=this;n.clearItems(),t.each(e||[],function(t,e){n.addSuggestion(e)})},n.showDropdown=function(){this.containerElement().show()},n.hideDropdown=function(){var t=this,e=t.containerElement();t._previousInputValue=null,e.hide()},n.addSuggestion=function(t){var e=this,n=e.opts(d),o=e.addDropdownItem(n?n.call(e,t):e.itemManager().itemToString(t));o.data(s,t)},n.addDropdownItem=function(e){var n=this,o=n.containerElement().find(".text-list"),i=t(n.opts(h));return i.find(".text-label").html(e),o.append(i),i},n.clearSelected=function(){this.suggestionElements().removeClass(i)},n.toggleNextSuggestion=function(){var t,e=this,n=e.selectedSuggestionElement();n.length>0?(t=n.next(),t.length>0&&n.removeClass(i)):t=e.suggestionElements().first(),t.addClass(i),e.scrollSuggestionIntoView(t)},n.togglePreviousSuggestion=function(){var t=this,e=t.selectedSuggestionElement(),n=e.prev();0!=n.length&&(t.clearSelected(),n.addClass(i),t.scrollSuggestionIntoView(n))},n.scrollSuggestionIntoView=function(t){var e=t.outerHeight(),n=this.containerElement(),o=n.innerHeight(),i=n.scrollTop(),r=(t.position()||{}).top,s=null,a=parseInt(n.css("paddingTop"));null!=r&&(r+e>o&&(s=r+i+e-o+a),0>r&&(s=r+i-a),null!=s&&n.scrollTop(s))},n.selectFromDropdown=function(){var t=this,e=t.selectedSuggestionElement().data(s);e&&(t.val(t.itemManager().itemToString(e)),t.core().getFormData()),t.trigger(m)},n.withinWrapElement=function(t){return this.core().wrapElement().find(t).size()>0}}(jQuery),function(t){function e(){}t.fn.textext.TextExtClear=e,t.fn.textext.addPlugin("clear",e);var n=e.prototype,o="html.clear",i={html:{clear:'<div class="text-clear"/>'}};n.init=function(e){var n,r=this;r.baseInit(e,i),r._clear=n=t(r.opts(o)),r.core().wrapElement().append(n),n.bind("click",function(t){r.onClearClick(t)})},n.onClearClick=function(e){var n=this;if("undefined"!=typeof n.core()._plugins.tags)for(var o=n.core()._plugins.tags.tagElements(),i=0;i<o.length;i++)n.core()._plugins.tags.removeTag(t(o[i]));n.val(""),n.core().getFormData()}}(jQuery),function(t){function e(){}t.fn.textext.TextExtFilter=e,t.fn.textext.addPlugin("filter",e);var n=e.prototype,o="filter.enabled",i={filter:{enabled:!0,items:null}};n.init=function(t){var e=this;e.baseInit(t,i),e.on({getFormData:e.onGetFormData,isTagAllowed:e.onIsTagAllowed,setSuggestions:e.onSetSuggestions}),e._suggestions=null},n.onGetFormData=function(t,e,n){var o=this,i=o.val(),r=i,s="";o.core().hasPlugin("tags")||(o.isValueAllowed(r)&&(s=i),e[300]=o.formDataObject(r,s))},n.isValueAllowed=function(t){var e,n=this,i=n.opts("filterItems")||n._suggestions||[],r=n.itemManager(),s=!n.opts(o);for(e=0;e<i.length&&!s;e++)r.compareItems(t,i[e])&&(s=!0);return s},n.onIsTagAllowed=function(t,e){e.result=this.isValueAllowed(e.tag)},n.onSetSuggestions=function(t,e){this._suggestions=e.result}}(jQuery),function(t){function e(){}t.fn.textext.TextExtFocus=e,t.fn.textext.addPlugin("focus",e);var n=e.prototype,o="html.focus",i={html:{focus:'<div class="text-focus"/>'}};n.init=function(t){var e=this;e.baseInit(t,i),e.core().wrapElement().append(e.opts(o)),e.on({blur:e.onBlur,focus:e.onFocus}),e._timeoutId=0},n.onBlur=function(t){var e=this;clearTimeout(e._timeoutId),e._timeoutId=setTimeout(function(){e.getFocus().hide()},100)},n.onFocus=function(t){var e=this;clearTimeout(e._timeoutId),e.getFocus().show()},n.getFocus=function(){return this.core().wrapElement().find(".text-focus")}}(jQuery),function(t){function e(){}t.fn.textext.TextExtPrompt=e,t.fn.textext.addPlugin("prompt",e);var n=e.prototype,o="text-hide-prompt",i="prompt",r="html.prompt",s={prompt:"Awaiting input...",html:{prompt:'<div class="text-prompt"/>'}};n.init=function(e){var n,o,a=this,u="placeholder";a.baseInit(e,s),n=t(a.opts(r)),t(a).data("container",n),a.core().wrapElement().append(n),a.setPrompt(a.opts(i)),o=e.input().attr(u),o||(o=a.opts(i)),e.input().attr(u,""),o&&a.setPrompt(o),t.trim(a.val()).length>0&&a.hidePrompt(),a.on({blur:a.onBlur,focus:a.onFocus,postInvalidate:a.onPostInvalidate,postInit:a.onPostInit})},n.onPostInit=function(t){this.invalidateBounds()},n.onPostInvalidate=function(t){this.invalidateBounds()},n.invalidateBounds=function(){var t=this,e=t.input();t.containerElement().css({paddingLeft:e.css("paddingLeft"),paddingTop:e.css("paddingTop")})},n.onBlur=function(t){var e=this;e.startTimer("prompt",.1,function(){e.showPrompt()})},n.showPrompt=function(){var e=this,n=e.input();0!==t.trim(e.val()).length||n.is(":focus")||e.containerElement().removeClass(o)},n.hidePrompt=function(){this.stopTimer("prompt"),this.containerElement().addClass(o)},n.onFocus=function(t){this.hidePrompt()},n.setPrompt=function(t){this.containerElement().text(t)},n.containerElement=function(){return t(this).data("container")}}(jQuery),function(t){function e(){}t.fn.textext.TextExtSuggestions=e,t.fn.textext.addPlugin("suggestions",e);var n=e.prototype,o="suggestions",i={suggestions:null};n.init=function(t){var e=this;e.baseInit(t,i),e.on({getSuggestions:e.onGetSuggestions,postInit:e.onPostInit})},n.setSuggestions=function(t,e){this.trigger("setSuggestions",{result:t,showHideDropdown:0!=e})},n.onPostInit=function(t){var e=this;e.setSuggestions(e.opts(o),!1)},n.onGetSuggestions=function(t,e){var n=this,i=n.opts(o);i.sort(),n.setSuggestions(n.itemManager().filter(i,e.query))}}(jQuery),function(t){function e(){}t.fn.textext.TextExtTags=e,t.fn.textext.addPlugin("tags",e);var n=e.prototype,o=".",i="text-tags-on-top",r=o+i,s="text-tag",a=o+s,u="text-tags",l=o+u,g="text-label",c=o+g,p="text-remove",d=o+p,f="tags.enabled",h="tags.items",m="html.tag",v="html.tags",x="isTagAllowed",w="tagClick",y={tags:{enabled:!0,items:null},html:{tags:'<div class="text-tags"/>',tag:'<div class="text-tag"><div class="text-button"><span class="text-label"/><a class="text-remove"/></div></div>'}};n.init=function(e){this.baseInit(e,y);var n,o=this,i=o.input();o.opts(f)&&(n=t(o.opts(v)),i.after(n),t(o).data("container",n),o.on({enterKeyPress:o.onEnterKeyPress,backspaceKeyDown:o.onBackspaceKeyDown,preInvalidate:o.onPreInvalidate,postInit:o.onPostInit,getFormData:o.onGetFormData}),o.on(n,{click:o.onClick,mousemove:o.onContainerMouseMove}),o.on(i,{mousemove:o.onInputMouseMove})),o._originalPadding={left:parseInt(i.css("paddingLeft")||0),top:parseInt(i.css("paddingTop")||0)},o._paddingBox={left:0,top:0},o.updateFormCache()},n.containerElement=function(){return t(this).data("container")},n.onPostInit=function(t){var e=this;e.addTags(e.opts(h))},n.onGetFormData=function(t,e,n){var o=this,i=13===n?"":o.val(),r=o._formData;e[200]=o.formDataObject(i,r)},n.initPriority=function(){return 100},n.onInputMouseMove=function(t){this.toggleZIndex(t)},n.onContainerMouseMove=function(t){this.toggleZIndex(t)},n.onBackspaceKeyDown=function(t){var e=this,n=e.tagElements().last();0==e.val().length&&e.removeTag(n)},n.onPreInvalidate=function(t){var e=this,n=e.tagElements().last(),o=n.position();n.length>0?o.left+=n.innerWidth():o=e._originalPadding,e._paddingBox=o,e.input().css({paddingLeft:o.left,paddingTop:o.top})},n.onClick=function(e){function n(t,e){o.data(s,t),o.find(c).text(i.itemManager().itemToString(t)),i.updateFormCache(),r.getFormData(),r.invalidateBounds(),e&&r.focusInput()}var o,i=this,r=i.core(),u=t(e.target),g=0;u.is(l)?g=1:u.is(d)?(i.removeTag(u.parents(a+":first")),g=1):u.is(c)&&(o=u.parents(a+":first"),i.trigger(w,o,o.data(s),n)),g&&r.focusInput()},n.onEnterKeyPress=function(t){this.trigger("getSuggestions",{query:""}),this.trigger("toggleDropdown");var e=this,n=e.val(),o=e.itemManager().stringToItem(n);e.isTagAllowed(o)&&(e.addTags([o]),e.core().focusInput())},n.updateFormCache=function(){var e=this,n=[];e.tagElements().each(function(){n.push(t(this).data(s))}),e._formData=n},n.toggleZIndex=function(t){var e=this,n=e.input().offset(),o=t.clientX-n.left,s=t.clientY-n.top,a=e._paddingBox,u=e.containerElement(),l=u.is(r),g=o>a.left&&s>a.top;(!l&&!g||l&&g)&&u[(l?"remove":"add")+"Class"](i)},n.tagElements=function(){return this.containerElement().find(a)},n.isTagAllowed=function(t){var e={tag:t,result:!0};return this.trigger(x,e),e.result===!0},n.addTags=function(t){if(t&&0!=t.length){var e,n,o=this,i=o.core(),r=o.containerElement();for(e=0;e<t.length;e++)n=t[e],n&&o.isTagAllowed(n)&&r.append(o.renderTag(n));o.updateFormCache(),i.getFormData(),i.invalidateBounds()}},n.getTagElement=function(e){var n,o,i=this,r=i.tagElements();for(n=0;n<r.length;n++)if(o=t(r[n]),i.itemManager().compareItems(o.data(s),e))return o;return null},n.removeTag=function(e){var n,o=this,i=o.core();if(e instanceof t)n=e,e=e.data(s);else if(n=o.getTagElement(e),null===n)return;n.remove(),o.updateFormCache(),i.getFormData(),i.invalidateBounds()},n.renderTag=function(e){var n=this,o=t(n.opts(m));return o.find(".text-label").text(n.itemManager().itemToString(e)),o.data(s,e),o}}(jQuery);